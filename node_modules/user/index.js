(function(){
	'use strict';
	
	var user = require('express').Router();
	var pg = require('pg');
	
	user
	.post('/', function(request, response){
		pg.connect(function(err, client){
			if (err) {
				console.error('User post controller', err);
				response.status(500);
			} else {
				var user = {
					username: request.body.username,
					password: request.body.password
				}
				client.query({
					text: 'SELECT id FROM sysinfo.users WHERE username = $1 AND password = $2',
					values: [
						user.username,
						user.password
					]}, function(err, result){
						if (err) {
							console.error('Error');
							response.status(500);
						} else {
							client.end();
							response.status(200).json(result.rows[0]);	
						}
				})
			}
		})
	})
	
	module.exports = user;
})();